<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Tracking BLR</title>
  <style>
    body{font-family:system-ui,Arial;padding:24px;max-width:700px;margin:auto}
    .card{border:1px solid #e5e7eb;border-radius:12px;padding:16px;margin:12px 0}
    input{padding:10px;border:1px solid #d1d5db;border-radius:10px;width:100%}
    button{padding:10px 16px;border-radius:10px;border:1px solid #9ca3af;cursor:pointer;margin-top:8px}
    .pill{padding:2px 8px;border-radius:999px;background:#f3f4f6;font-size:12px}
    table{width:100%;border-collapse:collapse;margin-top:8px}
    th,td{border-bottom:1px solid #eee;padding:8px;text-align:left}
  </style>
</head>
<body>
  <h2>Rastreo de paquetes</h2>
  <input id="code" placeholder="Ingresa tu código BLR-XXXXXX" />
  <button onclick="consultar()">Consultar</button>
  <div id="out"></div>

<script>
const API = 'TU_URL_WEBAPP?path=api/track&code='; // reemplaza TU_URL_WEBAPP

async function consultar(){
  const code = document.getElementById('code').value.trim();
  if(!code) return alert('Ingresa tu código');
  const r = await fetch(API+encodeURIComponent(code));
  const j = await r.json();
  if(!j.ok) { document.getElementById('out').innerHTML = '<p>No encontrado</p>'; return; }
  document.getElementById('out').innerHTML = `
    <div class="card">
      <b>Código:</b> ${j.cliente_code}<br/>
      <b>Libras pendientes:</b> ${j.lbs_pendientes}<br/>
      <b>Libras enviadas:</b> ${j.lbs_enviadas}
    </div>
    <div class="card">
      <h3>Pendientes</h3>
      ${tabla(j.pendientes)}
    </div>
    <div class="card">
      <h3>Enviados</h3>
      ${tabla(j.enviados)}
    </div>`;
}
function tabla(arr){
  if(!arr.length) return '<p>Sin registros</p>';
  return `<table><thead><tr><th>PKG</th><th>Peso</th><th>Estado</th><th>Actualizado</th></tr></thead><tbody>
    ${arr.map(x=>`<tr><td>${x.pkg_code}</td><td>${x.peso_lb}</td><td><span class="pill">${x.estado}</span></td><td>${x.fecha_estado||''}</td></tr>`).join('')}
  </tbody></table>`;
}
</script>
</body>
</html>
